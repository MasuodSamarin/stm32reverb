in directory cmake-build-debug:
cmake -G "Unix Makefiles" -DCMAKE_TOOLCHAIN_FILE=../arm-none-eabi-gcc.cmake -DCMAKE_BUILD_TYPE=Debug ..
cmake --build . -- -j 4

to clean:
cmake --build . --target clean -j 4

to program:
sudo st-flash write nucleo-f413zh.bin 0x8000000









prerequisites:
https://developer.arm.com/tools-and-software/open-source-software/developer-tools/gnu-toolchain/gnu-rm/downloads
https://cmake.org/download/
http://mingw-w64.org/doku.php
https://www.st.com/en/development-tools/stm32cubemx.html
https://github.com/stlink-org/stlink/releases/tag/v1.5.1

building stlink:
make release
cd build/Release; sudo make install
might have to tick with shared libraries not loading, fixed by setting LD_LIBRARY_PATH variable

editing CMakeLists.txt:
copy hal driver files from Makefile generated by Cube MX



The important website:
https://dev.to/younup/cmake-on-stm32-the-beginning-3766
